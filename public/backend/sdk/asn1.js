"use strict";function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _get=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var l=i.get;return void 0!==l?l.call(n):void 0},_createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.asn1js=e.asn1js||{})}(this,(function(e){function t(e,t,r){return e instanceof Object==0?r:t in e?e[t]:r}function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.byteLength,n="",i=!0,o=!1,l=void 0;try{for(var a,s=new Uint8Array(e,t,r)[Symbol.iterator]();!(i=(a=s.next()).done);i=!0){var u=a.value.toString(16).toUpperCase();n=n+(1===u.length?"0":"")+u}}catch(e){o=!0,l=e}finally{try{!i&&s.return&&s.return()}finally{if(o)throw l}}return n}function n(e,t,r,n){return t instanceof ArrayBuffer==0?(e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"',!1):0===t.byteLength?(e.error="Wrong parameter: inputBuffer has zero length",!1):r<0?(e.error="Wrong parameter: inputOffset less than zero",!1):n<0?(e.error="Wrong parameter: inputLength less than zero",!1):!(t.byteLength-r-n<0&&(e.error="End of input reached before message was fully decoded (inconsistent offset and length values)",1))}function i(e,t){for(var r=0,n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function o(e,t){for(var r=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:0)||-1,n=e,i=0,o=Math.pow(2,t),l=1;l<8;l++){if(e<o){var a=void 0;if(r<0)a=new ArrayBuffer(l),i=l;else{if(r<l)return new ArrayBuffer(0);a=new ArrayBuffer(r),i=r}for(var s=new Uint8Array(a),u=l-1;u>=0;u--){var c=Math.pow(2,u*t);s[i-u-1]=Math.floor(n/c),n-=s[i-u-1]*c}return a}o*=Math.pow(2,t)}return new ArrayBuffer(0)}function l(){for(var e=0,t=0,r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];var o=!0,l=!1,a=void 0;try{for(var s,u=n[Symbol.iterator]();!(o=(s=u.next()).done);o=!0)e+=s.value.byteLength}catch(e){l=!0,a=e}finally{try{!o&&u.return&&u.return()}finally{if(l)throw a}}var c=new ArrayBuffer(e),h=new Uint8Array(c),f=!0,v=!1,g=void 0;try{for(var k,y=n[Symbol.iterator]();!(f=(k=y.next()).done);f=!0){var d=k.value;h.set(new Uint8Array(d),t),t+=d.byteLength}}catch(e){v=!0,g=e}finally{try{!f&&y.return&&y.return()}finally{if(v)throw g}}return c}function a(){var e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){var t=255===e[0]&&128&e[1],r=0===e[0]&&0==(128&e[1]);(t||r)&&this.warnings.push("Needlessly long format")}for(var n=new ArrayBuffer(this.valueHex.byteLength),o=new Uint8Array(n),l=0;l<this.valueHex.byteLength;l++)o[l]=0;o[0]=128&e[0];for(var a=i(o,8),s=new ArrayBuffer(this.valueHex.byteLength),u=new Uint8Array(s),c=0;c<this.valueHex.byteLength;c++)u[c]=e[c];return u[0]&=127,i(u,8)-a}function s(e,t){if(e.byteLength!==t.byteLength)return!1;for(var r=new Uint8Array(e),n=new Uint8Array(t),i=0;i<r.length;i++)if(r[i]!==n[i])return!1;return!0}function u(e,t){for(var r=e.toString(10),n=t-r.length,i=new Array(n),o=0;o<n;o++)i[o]="0";return i.join("").concat(r)}function c(e,t,r){var i=t,o=new _({},Object);if(!1===n(new v,e,t,r))return o.error="Wrong input parameters",{offset:-1,result:o};if(0===new Uint8Array(e,t,r).length)return this.error="Zero buffer length",{offset:-1,result:o};var l=o.idBlock.fromBER(e,t,r);if(o.warnings.concat(o.idBlock.warnings),-1===l)return o.error=o.idBlock.error,{offset:-1,result:o};if(t=l,r-=o.idBlock.blockLength,l=o.lenBlock.fromBER(e,t,r),o.warnings.concat(o.lenBlock.warnings),-1===l)return o.error=o.lenBlock.error,{offset:-1,result:o};if(t=l,r-=o.lenBlock.blockLength,!1===o.idBlock.isConstructed&&!0===o.lenBlock.isIndefiniteForm)return o.error="Indefinite length form used for primitive encoding form",{offset:-1,result:o};var a=_;if(1===o.idBlock.tagClass){if(o.idBlock.tagNumber>=37&&!1===o.idBlock.isHexOnly)return o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard",{offset:-1,result:o};switch(o.idBlock.tagNumber){case 0:if(!0===o.idBlock.isConstructed&&o.lenBlock.length>0)return o.error="Type [UNIVERSAL 0] is reserved",{offset:-1,result:o};a=O;break;case 1:a=N;break;case 2:a=j;break;case 3:a=U;break;case 4:a=L;break;case 5:a=A;break;case 6:a=D;break;case 10:a=P;break;case 12:a=J;break;case 14:a=ue;break;case 15:return o.error="[UNIVERSAL 15] is reserved by ASN.1 standard",{offset:-1,result:o};case 16:a=x;break;case 17:a=S;break;case 18:a=$;break;case 19:a=q;break;case 20:a=Y;break;case 21:a=K;break;case 22:a=Q;break;case 23:a=ne;break;case 24:a=ie;break;case 25:a=X;break;case 26:a=ee;break;case 27:a=te;break;case 28:a=G;break;case 29:a=re;break;case 30:a=M;break;case 31:a=oe;break;case 32:a=le;break;case 33:a=ae;break;case 34:a=se;break;default:var s=void 0;(s=!0===o.idBlock.isConstructed?new m:new B).idBlock=o.idBlock,s.lenBlock=o.lenBlock,s.warnings=o.warnings,l=(o=s).fromBER(e,t,r)}}else a=!0===o.idBlock.isConstructed?m:B;return o=function(e,t){if(e instanceof t)return e;var r=new t;return r.idBlock=e.idBlock,r.lenBlock=e.lenBlock,r.warnings=e.warnings,r.valueBeforeDecode=e.valueBeforeDecode.slice(0),r}(o,a),l=o.fromBER(e,t,!0===o.lenBlock.isIndefiniteForm?r:o.lenBlock.length),o.valueBeforeDecode=e.slice(i,i+o.blockLength),{offset:l,result:o}}function h(e){if(0===e.byteLength){var t=new _({},Object);return t.error="Input buffer has zero length",{offset:-1,result:t}}return c(e,0,e.byteLength)}function f(e,t,r){if(r instanceof ce){for(var n=0;n<r.value.length;n++)if(!0===f(e,t,r.value[n]).verified)return{verified:!0,result:e};var i={verified:!1,result:{error:"Wrong values for Choice type"}};return r.hasOwnProperty("name")&&(i.name=r.name),i}if(r instanceof he)return r.hasOwnProperty("name")&&(e[r.name]=t),{verified:!0,result:e};if(e instanceof Object==0)return{verified:!1,result:{error:"Wrong root object"}};if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 data"}};if(r instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("idBlock"in r==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("fromBER"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if("toBER"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var o=r.idBlock.toBER(!1);if(0===o.byteLength)return{verified:!1,result:{error:"Error encoding idBlock for ASN.1 schema"}};if(-1===r.idBlock.fromBER(o,0,o.byteLength))return{verified:!1,result:{error:"Error decoding idBlock for ASN.1 schema"}};if(!1===r.idBlock.hasOwnProperty("tagClass"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagClass!==t.idBlock.tagClass)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("tagNumber"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.tagNumber!==t.idBlock.tagNumber)return{verified:!1,result:e};if(!1===r.idBlock.hasOwnProperty("isConstructed"))return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isConstructed!==t.idBlock.isConstructed)return{verified:!1,result:e};if("isHexOnly"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly)return{verified:!1,result:e};if(!0===r.idBlock.isHexOnly){if("valueHex"in r.idBlock==0)return{verified:!1,result:{error:"Wrong ASN.1 schema"}};var l=new Uint8Array(r.idBlock.valueHex),a=new Uint8Array(t.idBlock.valueHex);if(l.length!==a.length)return{verified:!1,result:e};for(var s=0;s<l.length;s++)if(l[s]!==a[1])return{verified:!1,result:e}}if(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(e[r.name]=t)),!0===r.idBlock.isConstructed){var u=0,c={verified:!1},v=r.valueBlock.value.length;if(v>0&&r.valueBlock.value[0]instanceof fe&&(v=t.valueBlock.value.length),0===v)return{verified:!0,result:e};if(0===t.valueBlock.value.length&&0!==r.valueBlock.value.length){for(var g=!0,k=0;k<r.valueBlock.value.length;k++)g=g&&(r.valueBlock.value[k].optional||!1);return!0===g?{verified:!0,result:e}:(r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),e.error="Inconsistent object length",{verified:!1,result:e})}for(var y=0;y<v;y++)if(y-u>=t.valueBlock.value.length){if(!1===r.valueBlock.value[y].optional){var d={verified:!1,result:e};return e.error="Inconsistent length between ASN.1 data and schema",r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],d.name=r.name)),d}}else if(r.valueBlock.value[0]instanceof fe){if(!1===(c=f(e,t.valueBlock.value[y],r.valueBlock.value[0].value)).verified){if(!0!==r.valueBlock.value[0].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),c;u++}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){var _={};void 0===(_="local"in r.valueBlock.value[0]&&!0===r.valueBlock.value[0].local?t:e)[r.valueBlock.value[0].name]&&(_[r.valueBlock.value[0].name]=[]),_[r.valueBlock.value[0].name].push(t.valueBlock.value[y])}}else if(!1===(c=f(e,t.valueBlock.value[y-u],r.valueBlock.value[y])).verified){if(!0!==r.valueBlock.value[y].optional)return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&delete e[r.name]),c;u++}if(!1===c.verified){var b={verified:!1,result:e};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],b.name=r.name)),b}return{verified:!0,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){var B=h(t.valueBlock.valueHex);if(-1===B.offset){var p={verified:!1,result:B.result};return r.hasOwnProperty("name")&&(r.name=r.name.replace(/^\s+|\s+$/g,""),""!==r.name&&(delete e[r.name],p.name=r.name)),p}return f(e,B.result,r.primitiveSchema)}return{verified:!0,result:e}}var v=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.blockLength=t(r,"blockLength",0),this.error=t(r,"error",""),this.warnings=t(r,"warnings",[]),this.valueBeforeDecode="valueBeforeDecode"in r?r.valueBeforeDecode.slice(0):new ArrayBuffer(0)}return _createClass(e,[{key:"toJSON",value:function(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:r(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}}}],[{key:"blockName",value:function(){return"baseBlock"}}]),e}(),g=function(e){return function(e){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,i);var r=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return r.isHexOnly=t(e,"isHexOnly",!1),r.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0),r}return _inherits(i,e),_createClass(i,[{key:"fromBER",value:function(e,t,r){return!1===n(this,e,t,r)?-1:0===new Uint8Array(e,t,r).length?(this.warnings.push("Zero buffer length"),t):(this.valueHex=e.slice(t,t+r),this.blockLength=r,t+r)}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!0!==this.isHexOnly?(this.error='Flag "isHexOnly" is not set, abort',new ArrayBuffer(0)):!0===e?new ArrayBuffer(this.valueHex.byteLength):this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJSON",this).call(this)}catch(e){}return e.blockName=this.constructor.blockName(),e.isHexOnly=this.isHexOnly,e.valueHex=r(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"hexBlock"}}]),i}(e)},k=function(e){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return"idBlock"in e?(n.isHexOnly=t(e.idBlock,"isHexOnly",!1),n.valueHex=t(e.idBlock,"valueHex",new ArrayBuffer(0)),n.tagClass=t(e.idBlock,"tagClass",-1),n.tagNumber=t(e.idBlock,"tagNumber",-1),n.isConstructed=t(e.idBlock,"isConstructed",!1)):(n.tagClass=-1,n.tagNumber=-1,n.isConstructed=!1),n}return _inherits(r,e),_createClass(r,[{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=0,r=void 0,n=void 0;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:return this.error="Unknown tag class",new ArrayBuffer(0)}if(this.isConstructed&&(t|=32),this.tagNumber<31&&!this.isHexOnly){if(r=new ArrayBuffer(1),n=new Uint8Array(r),!e){var i=this.tagNumber;t|=i&=31,n[0]=t}return r}if(!1===this.isHexOnly){var l=o(this.tagNumber,7),a=new Uint8Array(l),s=l.byteLength;if(r=new ArrayBuffer(s+1),(n=new Uint8Array(r))[0]=31|t,!e){for(var u=0;u<s-1;u++)n[u+1]=128|a[u];n[s]=a[s-1]}return r}if(r=new ArrayBuffer(this.valueHex.byteLength+1),(n=new Uint8Array(r))[0]=31|t,!1===e){for(var c=new Uint8Array(this.valueHex),h=0;h<c.length-1;h++)n[h+1]=128|c[h];n[this.valueHex.byteLength]=c[c.length-1]}return r}},{key:"fromBER",value:function(e,t,r){if(!1===n(this,e,t,r))return-1;var o=new Uint8Array(e,t,r);if(0===o.length)return this.error="Zero buffer length",-1;switch(192&o[0]){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:return this.error="Unknown tag class",-1}this.isConstructed=32==(32&o[0]),this.isHexOnly=!1;var l=31&o[0];if(31!==l)this.tagNumber=l,this.blockLength=1;else{var a=1;this.valueHex=new ArrayBuffer(255);for(var s=255,u=new Uint8Array(this.valueHex);128&o[a];){if(u[a-1]=127&o[a],++a>=o.length)return this.error="End of input reached before message was fully decoded",-1;if(a===s){s+=255;for(var c=new ArrayBuffer(s),h=new Uint8Array(c),f=0;f<u.length;f++)h[f]=u[f];this.valueHex=new ArrayBuffer(s),u=new Uint8Array(this.valueHex)}}this.blockLength=a+1,u[a-1]=127&o[a];for(var v=new ArrayBuffer(a),g=new Uint8Array(v),k=0;k<a;k++)g[k]=u[k];this.valueHex=new ArrayBuffer(a),(u=new Uint8Array(this.valueHex)).set(g),this.blockLength<=9?this.tagNumber=i(u,7):(this.isHexOnly=!0,this.warnings.push("Tag too long, represented as hex-coded"))}if(1===this.tagClass&&this.isConstructed)switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 14:case 23:case 24:case 31:case 32:case 33:case 34:return this.error="Constructed encoding used for primitive type",-1}return t+this.blockLength}},{key:"toJSON",value:function(){var e={};try{e=_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toJSON",this).call(this)}catch(e){}return e.blockName=this.constructor.blockName(),e.tagClass=this.tagClass,e.tagNumber=this.tagNumber,e.isConstructed=this.isConstructed,e}}],[{key:"blockName",value:function(){return"identificationBlock"}}]),r}(g(v)),y=function(e){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));return"lenBlock"in e?(n.isIndefiniteForm=t(e.lenBlock,"isIndefiniteForm",!1),n.longFormUsed=t(e.lenBlock,"longFormUsed",!1),n.length=t(e.lenBlock,"length",0)):(n.isIndefiniteForm=!1,n.longFormUsed=!1,n.length=0),n}return _inherits(r,e),_createClass(r,[{key:"fromBER",value:function(e,t,r){if(!1===n(this,e,t,r))return-1;var o=new Uint8Array(e,t,r);if(0===o.length)return this.error="Zero buffer length",-1;if(255===o[0])return this.error="Length block 0xFF is reserved by standard",-1;if(this.isIndefiniteForm=128===o[0],!0===this.isIndefiniteForm)return this.blockLength=1,t+this.blockLength;if(this.longFormUsed=!!(128&o[0]),!1===this.longFormUsed)return this.length=o[0],this.blockLength=1,t+this.blockLength;var l=127&o[0];if(l>8)return this.error="Too big integer",-1;if(l+1>o.length)return this.error="End of input reached before message was fully decoded",-1;for(var a=new Uint8Array(l),s=0;s<l;s++)a[s]=o[s+1];return 0===a[l-1]&&this.warnings.push("Needlessly long encoded length"),this.length=i(a,8),this.longFormUsed&&this.length<=127&&this.warnings.push("Unneccesary usage of long length form"),this.blockLength=l+1,t+this.blockLength}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,r=void 0;if(this.length>127&&(this.longFormUsed=!0),this.isIndefiniteForm)return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=128),t;if(!0===this.longFormUsed){var n=o(this.length,8);if(n.byteLength>127)return this.error="Too big length",new ArrayBuffer(0);if(t=new ArrayBuffer(n.byteLength+1),!0===e)return t;var i=new Uint8Array(n);(r=new Uint8Array(t))[0]=128|n.byteLength;for(var l=0;l<n.byteLength;l++)r[l+1]=i[l];return t}return t=new ArrayBuffer(1),!1===e&&((r=new Uint8Array(t))[0]=this.length),t}},{key:"toJSON",value:function(){var e={};try{e=_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toJSON",this).call(this)}catch(e){}return e.blockName=this.constructor.blockName(),e.isIndefiniteForm=this.isIndefiniteForm,e.longFormUsed=this.longFormUsed,e.length=this.length,e}}],[{key:"blockName",value:function(){return"lengthBlock"}}]),r}(v),d=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){throw TypeError('User need to make a specific function in a class which extends "LocalValueBlock"')}},{key:"toBER",value:function(){throw TypeError('User need to make a specific function in a class which extends "LocalValueBlock"')}}],[{key:"blockName",value:function(){return"valueBlock"}}]),t}(v),_=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"name"in e&&(n.name=e.name),"optional"in e&&(n.optional=e.optional),"primitiveSchema"in e&&(n.primitiveSchema=e.primitiveSchema),n.idBlock=new k(e),n.lenBlock=new y(e),n.valueBlock=new r(e),n}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,r=this.idBlock.toBER(e),n=this.valueBlock.toBER(!0);if(this.lenBlock.length=n.byteLength,t=l(r,this.lenBlock.toBER(e)),t=l(t,!1===e?this.valueBlock.toBER(e):new ArrayBuffer(this.lenBlock.length)),!0===this.lenBlock.isIndefiniteForm){var i=new ArrayBuffer(2);if(!1===e){var o=new Uint8Array(i);o[0]=0,o[1]=0}t=l(t,i)}return t}},{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.idBlock=this.idBlock.toJSON(),e.lenBlock=this.lenBlock.toJSON(),e.valueBlock=this.valueBlock.toJSON(),"name"in this&&(e.name=this.name),"optional"in this&&(e.optional=this.optional),"primitiveSchema"in this&&(e.primitiveSchema=this.primitiveSchema.toJSON()),e}}],[{key:"blockName",value:function(){return"BaseBlock"}}]),t}(v),b=function(e){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,i);var r=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return r.valueHex="valueHex"in e?e.valueHex.slice(0):new ArrayBuffer(0),r.isHexOnly=t(e,"isHexOnly",!0),r}return _inherits(i,e),_createClass(i,[{key:"fromBER",value:function(e,t,r){if(!1===n(this,e,t,r))return-1;var i=new Uint8Array(e,t,r);if(0===i.length)return this.warnings.push("Zero buffer length"),t;this.valueHex=new ArrayBuffer(i.length);for(var o=new Uint8Array(this.valueHex),l=0;l<i.length;l++)o[l]=i[l];return this.blockLength=r,t+r}},{key:"toBER",value:function(){return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJSON",this).call(this)}catch(e){}return e.valueHex=r(this.valueHex,0,this.valueHex.byteLength),e.isHexOnly=this.isHexOnly,e}}],[{key:"blockName",value:function(){return"PrimitiveValueBlock"}}]),i}(d),B=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,b));return r.idBlock.isConstructed=!1,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"PRIMITIVE"}}]),t}(_),p=function(e){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return n.value=t(e,"value",[]),n.isIndefiniteForm=t(e,"isIndefiniteForm",!1),n}return _inherits(r,e),_createClass(r,[{key:"fromBER",value:function(e,t,r){var i=t,o=r;if(!1===n(this,e,t,r))return-1;if(0===new Uint8Array(e,t,r).length)return this.warnings.push("Zero buffer length"),t;for(var l=t;function(e,t){return!0===e?1:t}(this.isIndefiniteForm,r)>0;){var a=c(e,l,r);if(-1===a.offset)return this.error=a.result.error,this.warnings.concat(a.result.warnings),-1;if(l=a.offset,this.blockLength+=a.result.blockLength,r-=a.result.blockLength,this.value.push(a.result),!0===this.isIndefiniteForm&&a.result.constructor.blockName()===O.blockName())break}return!0===this.isIndefiniteForm&&(this.value[this.value.length-1].constructor.blockName()===O.blockName()?this.value.pop():this.warnings.push("No EndOfContent block encoded")),this.valueBeforeDecode=e.slice(i,i+o),l}},{key:"toBER",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(0),r=0;r<this.value.length;r++)t=l(t,this.value[r].toBER(e));return t}},{key:"toJSON",value:function(){var e={};try{e=_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toJSON",this).call(this)}catch(e){}e.isIndefiniteForm=this.isIndefiniteForm,e.value=[];for(var t=0;t<this.value.length;t++)e.value.push(this.value[t].toJSON());return e}}],[{key:"blockName",value:function(){return"ConstructedValueBlock"}}]),r}(d),m=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,p));return r.idBlock.isConstructed=!0,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}}],[{key:"blockName",value:function(){return"CONSTRUCTED"}}]),t}(_),C=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){return t}},{key:"toBER",value:function(){return new ArrayBuffer(0)}}],[{key:"blockName",value:function(){return"EndOfContentValueBlock"}}]),t}(d),O=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,C));return r.idBlock.tagClass=1,r.idBlock.tagNumber=0,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"EndOfContent"}}]),t}(_),w=function(e){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,i);var r=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return r.value=t(e,"value",!1),r.isHexOnly=t(e,"isHexOnly",!1),"valueHex"in e?r.valueHex=e.valueHex.slice(0):(r.valueHex=new ArrayBuffer(1),!0===r.value&&(new Uint8Array(r.valueHex)[0]=255)),r}return _inherits(i,e),_createClass(i,[{key:"fromBER",value:function(e,t,r){if(!1===n(this,e,t,r))return-1;var i=new Uint8Array(e,t,r);r>1&&this.warnings.push("Boolean value encoded in more then 1 octet"),this.value=0!==i[0],this.isHexOnly=!0,this.valueHex=new ArrayBuffer(i.length);for(var o=new Uint8Array(this.valueHex),l=0;l<i.length;l++)o[l]=i[l];return this.blockLength=r,t+r}},{key:"toBER",value:function(){return this.valueHex}},{key:"toJSON",value:function(){var e={};try{e=_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e.isHexOnly=this.isHexOnly,e.valueHex=r(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"BooleanValueBlock"}}]),i}(d),N=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,w));return r.idBlock.tagClass=1,r.idBlock.tagNumber=1,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"Boolean"}}]),t}(_),x=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=16,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"Sequence"}}]),t}(m),S=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=17,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"Set"}}]),t}(m),A=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,v));return r.idBlock.tagClass=1,r.idBlock.tagNumber=5,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){return this.lenBlock.length>0&&this.warnings.push("Non-zero length of value block for Null type"),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),this.blockLength+=r,t+r}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(2);if(!0===e)return t;var r=new Uint8Array(t);return r[0]=5,r[1]=0,t}}],[{key:"blockName",value:function(){return"Null"}}]),t}(_),H=function(e){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,n);var r=_possibleConstructorReturn(this,(n.__proto__||Object.getPrototypeOf(n)).call(this,e));return r.isConstructed=t(e,"isConstructed",!1),r}return _inherits(n,e),_createClass(n,[{key:"fromBER",value:function(e,t,r){var i=0;if(!0===this.isConstructed){if(this.isHexOnly=!1,-1===(i=p.prototype.fromBER.call(this,e,t,r)))return i;for(var o=0;o<this.value.length;o++){var l=this.value[o].constructor.blockName();if(l===O.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only",-1}if(l!==L.blockName())return this.error="OCTET STRING may consists of OCTET STRINGs only",-1}}else this.isHexOnly=!0,i=_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"fromBER",this).call(this,e,t,r),this.blockLength=r;return i}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.isConstructed)return p.prototype.toBER.call(this,e);var t=new ArrayBuffer(this.valueHex.byteLength);return!0===e||0===this.valueHex.byteLength?t:t=this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=_get(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"toJSON",this).call(this)}catch(e){}return e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=r(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"OctetStringValueBlock"}}]),n}(g(p)),L=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,H));return r.idBlock.tagClass=1,r.idBlock.tagNumber=4,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,r,n){return this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,0===n?(0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),r):_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fromBER",this).call(this,e,r,n)}},{key:"isEqual",value:function(e){return e instanceof t!=0&&JSON.stringify(this)===JSON.stringify(e)}}],[{key:"blockName",value:function(){return"OctetString"}}]),t}(_),R=function(e){function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,i);var r=_possibleConstructorReturn(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e));return r.unusedBits=t(e,"unusedBits",0),r.isConstructed=t(e,"isConstructed",!1),r.blockLength=r.valueHex.byteLength+1,r}return _inherits(i,e),_createClass(i,[{key:"fromBER",value:function(e,t,r){if(0===r)return t;var i=-1;if(!0===this.isConstructed){if(-1===(i=p.prototype.fromBER.call(this,e,t,r)))return i;for(var o=0;o<this.value.length;o++){var l=this.value[o].constructor.blockName();if(l===O.blockName()){if(!0===this.isIndefiniteForm)break;return this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only",-1}if(l!==U.blockName())return this.error="BIT STRING may consists of BIT STRINGs only",-1;if(this.unusedBits>0&&this.value[o].unusedBits>0)return this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only',-1;if(this.unusedBits=this.value[o].unusedBits,this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1}return i}if(!1===n(this,e,t,r))return-1;var a=new Uint8Array(e,t,r);if(this.unusedBits=a[0],this.unusedBits>7)return this.error="Unused bits for BitString must be in range 0-7",-1;this.valueHex=new ArrayBuffer(a.length-1);for(var s=new Uint8Array(this.valueHex),u=0;u<r-1;u++)s[u]=a[u+1];return this.blockLength=a.length,t+r}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!0===this.isConstructed)return p.prototype.toBER.call(this,e);if(!0===e)return new ArrayBuffer(this.valueHex.byteLength+1);if(0===this.valueHex.byteLength)return new ArrayBuffer(0);var t=new Uint8Array(this.valueHex),r=new ArrayBuffer(this.valueHex.byteLength+1),n=new Uint8Array(r);n[0]=this.unusedBits;for(var i=0;i<this.valueHex.byteLength;i++)n[i+1]=t[i];return r}},{key:"toJSON",value:function(){var e={};try{e=_get(i.prototype.__proto__||Object.getPrototypeOf(i.prototype),"toJSON",this).call(this)}catch(e){}return e.unusedBits=this.unusedBits,e.isConstructed=this.isConstructed,e.isHexOnly=this.isHexOnly,e.valueHex=r(this.valueHex,0,this.valueHex.byteLength),e}}],[{key:"blockName",value:function(){return"BitStringValueBlock"}}]),i}(g(p)),U=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,R));return r.idBlock.tagClass=1,r.idBlock.tagNumber=3,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,r,n){return 0===n?r:(this.valueBlock.isConstructed=this.idBlock.isConstructed,this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm,_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fromBER",this).call(this,e,r,n))}},{key:"isEqual",value:function(e){return e instanceof t!=0&&JSON.stringify(this)===JSON.stringify(e)}}],[{key:"blockName",value:function(){return"BitString"}}]),t}(_),E=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return"value"in e&&(r.valueDec=e.value),r}return _inherits(t,e),_createClass(t,[{key:"fromDER",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=this.fromBER(e,t,r);if(-1===i)return i;var o=new Uint8Array(this._valueHex);if(0===o[0]&&0!=(128&o[1])){var l=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(l).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=l.slice(0)}else if(0!==n&&this._valueHex.byteLength<n){n-this._valueHex.byteLength>1&&(n=this._valueHex.byteLength+1);var a=new ArrayBuffer(n);new Uint8Array(a).set(o,n-this._valueHex.byteLength),this._valueHex=a.slice(0)}return i}},{key:"toDER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new Uint8Array(this._valueHex);switch(!0){case 0!=(128&t[0]):var r=new ArrayBuffer(this._valueHex.byteLength+1),n=new Uint8Array(r);n[0]=0,n.set(t,1),this._valueHex=r.slice(0);break;case 0===t[0]&&0==(128&t[1]):var i=new ArrayBuffer(this._valueHex.byteLength-1);new Uint8Array(i).set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1)),this._valueHex=i.slice(0)}return this.toBER(e)}},{key:"fromBER",value:function(e,r,n){var i=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"fromBER",this).call(this,e,r,n);return-1===i?i:(this.blockLength=n,r+n)}},{key:"toBER",value:function(){return this.valueHex.slice(0)}},{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.valueDec=this.valueDec,e}},{key:"valueHex",set:function(e){this._valueHex=e.slice(0),e.byteLength>=4?(this.warnings.push("Too big Integer for decoding, hex only"),this.isHexOnly=!0,this._valueDec=0):(this.isHexOnly=!1,e.byteLength>0&&(this._valueDec=a.call(this)))},get:function(){return this._valueHex}},{key:"valueDec",set:function(e){this._valueDec=e,this.isHexOnly=!1,this._valueHex=function(e){for(var t=e<0?-1*e:e,r=128,n=1;n<8;n++){if(t<=r){if(e<0){var i=o(r-t,8,n);return new Uint8Array(i)[0]|=128,i}var l=o(t,8,n),a=new Uint8Array(l);if(128&a[0]){var s=l.slice(0),u=new Uint8Array(s);l=new ArrayBuffer(l.byteLength+1),a=new Uint8Array(l);for(var c=0;c<s.byteLength;c++)a[c+1]=u[c];a[0]=0}return l}r*=Math.pow(2,8)}return new ArrayBuffer(0)}(e)},get:function(){return this._valueDec}}],[{key:"blockName",value:function(){return"IntegerValueBlock"}}]),t}(g(d)),j=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,E));return r.idBlock.tagClass=1,r.idBlock.tagNumber=2,r}return _inherits(t,e),_createClass(t,[{key:"isEqual",value:function(e){return e instanceof t?this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly?s(this.valueBlock.valueHex,e.valueBlock.valueHex):this.valueBlock.isHexOnly===e.valueBlock.isHexOnly&&this.valueBlock.valueDec===e.valueBlock.valueDec:e instanceof ArrayBuffer&&s(this.valueBlock.valueHex,e)}},{key:"convertToDER",value:function(){var e=new t({valueHex:this.valueBlock.valueHex});return e.valueBlock.toDER(),e}},{key:"convertFromDER",value:function(){var e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength,r=new t({valueHex:this.valueBlock.valueHex});return r.valueBlock.fromDER(r.valueBlock.valueHex,0,r.valueBlock.valueHex.byteLength,e),r}}],[{key:"blockName",value:function(){return"Integer"}}]),t}(_),P=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=10,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"Enumerated"}}]),t}(j),I=function(e){function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,l);var r=_possibleConstructorReturn(this,(l.__proto__||Object.getPrototypeOf(l)).call(this,e));return r.valueDec=t(e,"valueDec",-1),r.isFirstSid=t(e,"isFirstSid",!1),r}return _inherits(l,e),_createClass(l,[{key:"fromBER",value:function(e,t,r){if(0===r)return t;if(!1===n(this,e,t,r))return-1;var o=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);for(var l=new Uint8Array(this.valueHex),a=0;a<r&&(l[a]=127&o[a],this.blockLength++,0!=(128&o[a]));a++);for(var s=new ArrayBuffer(this.blockLength),u=new Uint8Array(s),c=0;c<this.blockLength;c++)u[c]=l[c];return this.valueHex=s.slice(0),l=new Uint8Array(this.valueHex),0!=(128&o[this.blockLength-1])?(this.error="End of input reached before message was fully decoded",-1):(0===l[0]&&this.warnings.push("Needlessly long format of SID encoding"),this.blockLength<=8?this.valueDec=i(l,7):(this.isHexOnly=!0,this.warnings.push("Too big SID for decoding, hex only")),t+this.blockLength)}},{key:"toBER",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=void 0,r=void 0;if(this.isHexOnly){if(!0===e)return new ArrayBuffer(this.valueHex.byteLength);var n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength),r=new Uint8Array(t);for(var i=0;i<this.blockLength-1;i++)r[i]=128|n[i];return r[this.blockLength-1]=n[this.blockLength-1],t}var l=o(this.valueDec,7);if(0===l.byteLength)return this.error="Error during encoding SID value",new ArrayBuffer(0);if(t=new ArrayBuffer(l.byteLength),!1===e){var a=new Uint8Array(l);r=new Uint8Array(t);for(var s=0;s<l.byteLength-1;s++)r[s]=128|a[s];r[l.byteLength-1]=a[l.byteLength-1]}return t}},{key:"toString",value:function(){var e="";if(!0===this.isHexOnly)e=r(this.valueHex,0,this.valueHex.byteLength);else if(this.isFirstSid){var t=this.valueDec;this.valueDec<=39?e="0.":this.valueDec<=79?(e="1.",t-=40):(e="2.",t-=80),e+=t.toString()}else e=this.valueDec.toString();return e}},{key:"toJSON",value:function(){var e={};try{e=_get(l.prototype.__proto__||Object.getPrototypeOf(l.prototype),"toJSON",this).call(this)}catch(e){}return e.valueDec=this.valueDec,e.isFirstSid=this.isFirstSid,e}}],[{key:"blockName",value:function(){return"sidBlock"}}]),l}(g(v)),T=function(e){function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,r);var n=_possibleConstructorReturn(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e));return n.fromString(t(e,"value","")),n}return _inherits(r,e),_createClass(r,[{key:"fromBER",value:function(e,t,r){for(var n=t;r>0;){var i=new I;if(-1===(n=i.fromBER(e,n,r)))return this.blockLength=0,this.error=i.error,n;0===this.value.length&&(i.isFirstSid=!0),this.blockLength+=i.blockLength,r-=i.blockLength,this.value.push(i)}return n}},{key:"toBER",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new ArrayBuffer(0),r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);if(0===n.byteLength)return this.error=this.value[r].error,new ArrayBuffer(0);t=l(t,n)}return t}},{key:"fromString",value:function(e){this.value=[];var t=0,r=0,n="",i=!1;do{if(n=-1===(r=e.indexOf(".",t))?e.substr(t):e.substr(t,r-t),t=r+1,i){var o=this.value[0],l=0;switch(o.valueDec){case 0:break;case 1:l=40;break;case 2:l=80;break;default:return this.value=[],!1}var a=parseInt(n,10);if(isNaN(a))return!0;o.valueDec=a+l,i=!1}else{var s=new I;if(s.valueDec=parseInt(n,10),isNaN(s.valueDec))return!0;0===this.value.length&&(s.isFirstSid=!0,i=!0),this.value.push(s)}}while(-1!==r);return!0}},{key:"toString",value:function(){for(var e="",t=!1,r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;var n=this.value[r].toString();0!==r&&(e+="."),t?(n="{"+n+"}",this.value[r].isFirstSid?e="2.{"+n+" - 80}":e+=n):e+=n}return e}},{key:"toJSON",value:function(){var e={};try{e=_get(r.prototype.__proto__||Object.getPrototypeOf(r.prototype),"toJSON",this).call(this)}catch(e){}e.value=this.toString(),e.sidArray=[];for(var t=0;t<this.value.length;t++)e.sidArray.push(this.value[t].toJSON());return e}}],[{key:"blockName",value:function(){return"ObjectIdentifierValueBlock"}}]),r}(d),D=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,T));return r.idBlock.tagClass=1,r.idBlock.tagNumber=6,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"ObjectIdentifier"}}]),t}(_),F=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isHexOnly=!0,r.value="",r}return _inherits(t,e),_createClass(t,[{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"Utf8StringValueBlock"}}]),t}(g(v)),J=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,F));return"value"in e&&r.fromString(e.value),r.idBlock.tagClass=1,r.idBlock.tagNumber=12,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(e){this.warnings.push('Error during "decodeURIComponent": '+e+", using raw string")}}},{key:"fromString",value:function(e){var t=unescape(encodeURIComponent(e)),r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);for(var n=new Uint8Array(this.valueBlock.valueHex),i=0;i<r;i++)n[i]=t.charCodeAt(i);this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"Utf8String"}}]),t}(_),W=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isHexOnly=!0,r.value="",r}return _inherits(t,e),_createClass(t,[{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"BmpStringValueBlock"}}]),t}(g(v)),M=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,W));return"value"in e&&r.fromString(e.value),r.idBlock.tagClass=1,r.idBlock.tagNumber=30,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){for(var t=e.slice(0),r=new Uint8Array(t),n=0;n<r.length;n+=2){var i=r[n];r[n]=r[n+1],r[n+1]=i}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(2*t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++){var i=o(e.charCodeAt(n),8),l=new Uint8Array(i);if(!(l.length>2))for(var a=2-l.length,s=l.length-1;s>=0;s--)r[2*n+s+a]=l[s]}this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"BmpString"}}]),t}(_),V=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.isHexOnly=!0,r.value="",r}return _inherits(t,e),_createClass(t,[{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"UniversalStringValueBlock"}}]),t}(g(v)),G=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,V));return"value"in e&&r.fromString(e.value),r.idBlock.tagClass=1,r.idBlock.tagNumber=28,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){for(var t=e.slice(0),r=new Uint8Array(t),n=0;n<r.length;n+=4)r[n]=r[n+3],r[n+1]=r[n+2],r[n+2]=0,r[n+3]=0;this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(4*t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++){var i=o(e.charCodeAt(n),8),l=new Uint8Array(i);if(!(l.length>4))for(var a=4-l.length,s=l.length-1;s>=0;s--)r[4*n+s+a]=l[s]}this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"UniversalString"}}]),t}(_),Z=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.value="",r.isHexOnly=!0,r}return _inherits(t,e),_createClass(t,[{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.value=this.value,e}}],[{key:"blockName",value:function(){return"SimpleStringValueBlock"}}]),t}(g(v)),z=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,Z));return"value"in e&&r.fromString(e.value),r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))}},{key:"fromString",value:function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);for(var r=new Uint8Array(this.valueBlock.valueHex),n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e}}],[{key:"blockName",value:function(){return"SIMPLESTRING"}}]),t}(_),$=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=18,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"NumericString"}}]),t}(z),q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=19,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"PrintableString"}}]),t}(z),Y=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=20,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"TeletexString"}}]),t}(z),K=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=21,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"VideotexString"}}]),t}(z),Q=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=22,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"IA5String"}}]),t}(z),X=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=25,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"GraphicString"}}]),t}(z),ee=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=26,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"VisibleString"}}]),t}(z),te=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=27,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"GeneralString"}}]),t}(z),re=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=29,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"CharacterString"}}]),t}(z),ne=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(r.year=0,r.month=0,r.day=0,r.hour=0,r.minute=0,r.second=0,"value"in e){r.fromString(e.value),r.valueBlock.valueHex=new ArrayBuffer(e.value.length);for(var n=new Uint8Array(r.valueBlock.valueHex),i=0;i<e.value.length;i++)n[i]=e.value.charCodeAt(i)}return"valueDate"in e&&(r.fromDate(e.valueDate),r.valueBlock.valueHex=r.toBuffer()),r.idBlock.tagClass=1,r.idBlock.tagNumber=23,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}},{key:"toBuffer",value:function(){for(var e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}},{key:"fromDate",value:function(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))}},{key:"fromString",value:function(e){var t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi.exec(e);if(null!==t){var r=parseInt(t[1],10);this.year=r>=50?1900+r:2e3+r,this.month=parseInt(t[2],10),this.day=parseInt(t[3],10),this.hour=parseInt(t[4],10),this.minute=parseInt(t[5],10),this.second=parseInt(t[6],10)}else this.error="Wrong input string for convertion"}},{key:"toString",value:function(){var e=new Array(7);return e[0]=u(this.year<2e3?this.year-1900:this.year-2e3,2),e[1]=u(this.month,2),e[2]=u(this.day,2),e[3]=u(this.hour,2),e[4]=u(this.minute,2),e[5]=u(this.second,2),e[6]="Z",e.join("")}},{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e}}],[{key:"blockName",value:function(){return"UTCTime"}}]),t}(ee),ie=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));if(r.year=0,r.month=0,r.day=0,r.hour=0,r.minute=0,r.second=0,r.millisecond=0,"value"in e){r.fromString(e.value),r.valueBlock.valueHex=new ArrayBuffer(e.value.length);for(var n=new Uint8Array(r.valueBlock.valueHex),i=0;i<e.value.length;i++)n[i]=e.value.charCodeAt(i)}return"valueDate"in e&&(r.fromDate(e.valueDate),r.valueBlock.valueHex=r.toBuffer()),r.idBlock.tagClass=1,r.idBlock.tagNumber=24,r}return _inherits(t,e),_createClass(t,[{key:"fromBER",value:function(e,t,r){var n=this.valueBlock.fromBER(e,t,!0===this.lenBlock.isIndefiniteForm?r:this.lenBlock.length);return-1===n?(this.error=this.valueBlock.error,n):(this.fromBuffer(this.valueBlock.valueHex),0===this.idBlock.error.length&&(this.blockLength+=this.idBlock.blockLength),0===this.lenBlock.error.length&&(this.blockLength+=this.lenBlock.blockLength),0===this.valueBlock.error.length&&(this.blockLength+=this.valueBlock.blockLength),n)}},{key:"fromBuffer",value:function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))}},{key:"toBuffer",value:function(){for(var e=this.toString(),t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t}},{key:"fromDate",value:function(e){this.year=e.getUTCFullYear(),this.month=e.getUTCMonth()+1,this.day=e.getUTCDate(),this.hour=e.getUTCHours(),this.minute=e.getUTCMinutes(),this.second=e.getUTCSeconds(),this.millisecond=e.getUTCMilliseconds()}},{key:"toDate",value:function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))}},{key:"fromString",value:function(e){var t=!1,r="",n="",i=0,o=void 0,l=0,a=0;if("Z"===e[e.length-1])r=e.substr(0,e.length-1),t=!0;else{var s=new Number(e[e.length-1]);if(isNaN(s.valueOf()))throw new Error("Wrong input string for convertion");r=e}if(t){if(-1!==r.indexOf("+"))throw new Error("Wrong input string for convertion");if(-1!==r.indexOf("-"))throw new Error("Wrong input string for convertion")}else{var u=1,c=r.indexOf("+"),h="";if(-1===c&&(c=r.indexOf("-"),u=-1),-1!==c){if(h=r.substr(c+1),r=r.substr(0,c),2!==h.length&&4!==h.length)throw new Error("Wrong input string for convertion");var f=new Number(h.substr(0,2));if(isNaN(f.valueOf()))throw new Error("Wrong input string for convertion");if(l=u*f,4===h.length){if(f=new Number(h.substr(2,2)),isNaN(f.valueOf()))throw new Error("Wrong input string for convertion");a=u*f}}}var v=r.indexOf(".");if(-1===v&&(v=r.indexOf(",")),-1!==v){var g=new Number("0"+r.substr(v));if(isNaN(g.valueOf()))throw new Error("Wrong input string for convertion");i=g.valueOf(),n=r.substr(0,v)}else n=r;switch(!0){case 8===n.length:if(o=/(\d{4})(\d{2})(\d{2})/gi,-1!==v)throw new Error("Wrong input string for convertion");break;case 10===n.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})/gi,-1!==v){var k=60*i;this.minute=Math.floor(k),k=60*(k-this.minute),this.second=Math.floor(k),k=1e3*(k-this.second),this.millisecond=Math.floor(k)}break;case 12===n.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==v){var y=60*i;this.second=Math.floor(y),y=1e3*(y-this.second),this.millisecond=Math.floor(y)}break;case 14===n.length:if(o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi,-1!==v){var d=1e3*i;this.millisecond=Math.floor(d)}break;default:throw new Error("Wrong input string for convertion")}var _=o.exec(n);if(null===_)throw new Error("Wrong input string for convertion");for(var b=1;b<_.length;b++)switch(b){case 1:this.year=parseInt(_[b],10);break;case 2:this.month=parseInt(_[b],10);break;case 3:this.day=parseInt(_[b],10);break;case 4:this.hour=parseInt(_[b],10)+l;break;case 5:this.minute=parseInt(_[b],10)+a;break;case 6:this.second=parseInt(_[b],10);break;default:throw new Error("Wrong input string for convertion")}if(!1===t){var B=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=B.getUTCFullYear(),this.month=B.getUTCMonth(),this.day=B.getUTCDay(),this.hour=B.getUTCHours(),this.minute=B.getUTCMinutes(),this.second=B.getUTCSeconds(),this.millisecond=B.getUTCMilliseconds()}}},{key:"toString",value:function(){var e=[];return e.push(u(this.year,4)),e.push(u(this.month,2)),e.push(u(this.day,2)),e.push(u(this.hour,2)),e.push(u(this.minute,2)),e.push(u(this.second,2)),0!==this.millisecond&&(e.push("."),e.push(u(this.millisecond,3))),e.push("Z"),e.join("")}},{key:"toJSON",value:function(){var e={};try{e=_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toJSON",this).call(this)}catch(e){}return e.year=this.year,e.month=this.month,e.day=this.day,e.hour=this.hour,e.minute=this.minute,e.second=this.second,e.millisecond=this.millisecond,e}}],[{key:"blockName",value:function(){return"GeneralizedTime"}}]),t}(ee),oe=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=31,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"DATE"}}]),t}(J),le=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=32,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"TimeOfDay"}}]),t}(J),ae=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=33,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"DateTime"}}]),t}(J),se=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=34,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"Duration"}}]),t}(J),ue=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,t);var r=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.idBlock.tagClass=1,r.idBlock.tagNumber=14,r}return _inherits(t,e),_createClass(t,null,[{key:"blockName",value:function(){return"TIME"}}]),t}(J),ce=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.value=t(r,"value",[]),this.optional=t(r,"optional",!1)},he=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.name=t(r,"name",""),this.optional=t(r,"optional",!1)},fe=function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.name=t(r,"name",""),this.optional=t(r,"optional",!1),this.value=t(r,"value",new he),this.local=t(r,"local",!1)},ve=function(){function e(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),this.data=t(r,"data",new ArrayBuffer(0))}return _createClass(e,[{key:"fromBER",value:function(e,t,r){this.data=e.slice(t,r)}},{key:"toBER",value:function(){return this.data}}]),e}();e.BaseBlock=_,e.Primitive=B,e.Constructed=m,e.EndOfContent=O,e.Boolean=N,e.Sequence=x,e.Set=S,e.Null=A,e.OctetString=L,e.BitString=U,e.Integer=j,e.Enumerated=P,e.ObjectIdentifier=D,e.Utf8String=J,e.BmpString=M,e.UniversalString=G,e.NumericString=$,e.PrintableString=q,e.TeletexString=Y,e.VideotexString=K,e.IA5String=Q,e.GraphicString=X,e.VisibleString=ee,e.GeneralString=te,e.CharacterString=re,e.UTCTime=ne,e.GeneralizedTime=ie,e.DATE=oe,e.TimeOfDay=le,e.DateTime=ae,e.Duration=se,e.TIME=ue,e.Choice=ce,e.Any=he,e.Repeated=fe,e.RawData=ve,e.fromBER=h,e.compareSchema=f,e.verifySchema=function(e,t){if(t instanceof Object==0)return{verified:!1,result:{error:"Wrong ASN.1 schema type"}};var r=h(e);return-1===r.offset?{verified:!1,result:r.result}:f(r.result,r.result,t)},e.fromJSON=function(e){},Object.defineProperty(e,"__esModule",{value:!0})}));